!function(e,t){let n=null,o=null,i=null,l=null,c=null,s=null,a=0,m=0,r=0,h=null,u=null,d="current",p=null,f=null,v=null,g=null,x=null,w=0,_=0,y=[],z=null,I=null,W=null,H=null,$=null,M=null,P=0,b=0,B=0,j=0,k={},q={navWidth:60,navHeight:60,navItemNum:5,navItemMargin:7,navBorder:1,autoPlay:!0,autoPlayTimeout:2e3},N={init:function(t){let c=e.extend({},q,t);o=(n=this).find(".ecommercezoom_img_box"),s=n.find(".ecommercezoom_img_ul"),h=n.find(".ecommercezoom_nav"),g=n.find(".ecommercezoom_prev_btn"),x=n.find(".ecommercezoom_next_btn"),l=i=n.outerWidth(),k.navWidth=c.navWidth,k.navHeight=c.navHeight,k.navBorder=c.navBorder,k.navItemMargin=c.navItemMargin,k.navItemNum=c.navItemNum,k.autoPlay=c.autoPlay,k.autoPlayTimeout=c.autoPlayTimeout,v=o.find("img"),w=v.length,function(e){let t=setInterval(function(){let n=0,o=e.length;e.each(function(){this.complete&&n++}),n===o&&(clearInterval(t),T())},100)}(v)},prev:function(){A()},next:function(){Y()},setImg:function(){let e=arguments[0];E(e,function(t,n){$.attr("src",e),I.attr("src",e),s.find("li").length===w+1&&s.find("li:last").remove(),s.append('<li style="width: '+i+'px;"><img src="'+e+'"></li>'),D(F(e,t,n))})}};function T(){o.append("<div class='ecommercezoom_img_ul_outer'></div>"),h.append("<p class='ecommercezoom_nav_inner'></p>"),c=o.find(".ecommercezoom_img_ul_outer"),u=h.find(".ecommercezoom_nav_inner"),c.append(s);for(let e=0;e<w;e++){y[e]=F(v.eq(e)),console.log(y[e]);let t=s.find("li").eq(e);t.css("width",i),t.find("img").css({"margin-top":y[e][5],width:y[e][3]})}p=h.find("span"),f=2*k.navBorder+k.navHeight,k.ecommercezoom_navWidth=(f+k.navItemMargin)*k.navItemNum,k.ecommercezoom_nav_innerWidth=(f+k.navItemMargin)*w,p.eq(_).addClass(d),h.css({height:f+"px",width:i-g.width()-x.width()}),u.css({width:k.ecommercezoom_nav_innerWidth+"px"}),p.css({"margin-left":k.navItemMargin+"px",width:k.navWidth+"px",height:k.navHeight+"px"}),m=i*w,r=i*(w-1),s.css("width",m),o.append("\n\t\t<div class='ecommercezoom_zoom_outer'>\n\t\t\t<span class='ecommercezoom_zoom'></span>\n\t\t</div>\n\t\t<p class='ecommercezoom_preview'>\n\t\t\t<img class='ecommercezoom_preview_img' src='' />\n\t\t</p>\n\t\t\t\t\t"),z=o.find(".ecommercezoom_zoom"),I=o.find(".ecommercezoom_main_img"),W=o.find(".ecommercezoom_zoom_outer"),H=o.find(".ecommercezoom_preview"),$=o.find(".ecommercezoom_preview_img"),o.css({width:l+"px",height:l+"px"}),c.css({width:l+"px",height:l+"px"}),H.css({width:l+"px",height:l+"px",left:l+5+"px"}),D(y[_]),S(),s.on("touchstart",function(e){let n=C(e);P=n.x,b=n.y;let o=s.css("left");a=parseInt(o),t.clearInterval(M)}),s.on("touchmove",function(e){let t,n=C(e);B=n.x,j=n.y,t=Q(t=a+B-P),s.css("left",t)}),s.on("touchend",function(e){console.log(B<P),B<P?Y():B>P&&A(),S()}),W.on("mousedown",function(e){let t=C(e);P=t.x,b=t.y;let n=s.css("left");a=parseInt(n)}),W.on("mouseup",function(e){let t=n.offset();P-t.left<i/2?A():P-t.left>i/2&&Y()}),n.on("mouseenter",function(){t.clearInterval(M)}),n.on("mouseleave",function(){S()}),W.on("mouseenter",function(){z.css("display","block"),H.css("display","block")}),W.on("mousemove",function(e){let t=z.width()/2,n=W.width()-t,o=W.height()-t,i=e.pageX-W.offset().left,l=e.pageY-W.offset().top,c=i-t,s=l-t;i<=t&&(c=0),i>=n&&(c=n-t),l<=t&&(s=0),l>=o&&(s=o-t),z.css({left:c+"px",top:s+"px"}),$.css({left:-c*H.width()/z.width()+"px",top:-s*H.width()/z.width()+"px"})}),W.on("mouseleave",function(){z.css("display","none"),H.css("display","none")}),H.on("mouseenter",function(){z.css("display","none"),H.css("display","none")}),x.on("click",function(){Y()}),g.on("click",function(){A()}),p.hover(function(){X(_=e(this).index())})}function C(e){let n,o,i=e||t.event,l=i;return void 0!==i.touches&&i.touches.length>0&&(l=i.touches[0]),{x:n=l.clientX||l.pageX,y:o=l.clientY||l.pageY}}function Q(e){return-e>r?(e=-r,_=0):e>0&&(e=0),e}function X(e){void 0===e&&alert("ecommercezoom 中的 move 函数的 direction 参数必填"),_>y.length-1&&(_=0),p.eq(_).addClass(d).siblings().removeClass(d);let t=h.width(),n=0,o=(k.navItemMargin+k.navWidth+2*k.navBorder)*(_+1);o>t&&(n=i-o),u.css({left:n});let l=-i*_;l=Q(l),s.stop().animate({left:l},500),D(y[_])}function Y(){++_>w&&(_=w),X("right")}function A(){--_<0&&(_=0),X("left")}function S(){k.autoPlay&&(M=t.setInterval(function(){_>=w&&(_=0),_++,X("right")},k.autoPlayTimeout))}function D(e){void 0!==e&&($.attr("src",e[0]),I.attr("src",e[0]).css({width:e[3]+"px",height:e[4]+"px"}),W.css({width:e[3]+"px",height:e[4]+"px",top:e[5]+"px",left:e[6]+"px",position:"relative"}),z.css({width:e[7]+"px",height:e[7]+"px"}),$.css({width:e[8]+"px",height:e[9]+"px"}))}function E(e,t){let n=new Image;if(n.src=e,void 0===t)return{width:n.width,height:n.height};n.complete?t(n.width,n.height):n.onload=function(){t(n.width,n.height)}}function F(e,t,n){let o,i=[];if("string"==typeof e)o=e;else{let i=E(o=e.attr("src"));t=i.width,n=i.height}i[0]=o,i[1]=t,i[2]=n;let c=i[1]/i[2];if(1===c)i[3]=l,i[4]=l,i[5]=0,i[6]=0,i[7]=l/2,i[8]=2*l,i[9]=2*l,u.append(`<span><img src="${o}" width="${k.navWidth}" height="${k.navHeight}"/></span>`);else if(c>1){i[3]=l,i[4]=l/c,i[5]=(l-i[4])/2,i[6]=0,i[7]=i[4]/2,i[8]=2*l*c,i[9]=2*l;let e=(k.navHeight-k.navWidth/c)/2;u.append(`<span><img src="${o}" width="${k.navWidth}" style='top:${e}px;' /></span>`)}else if(c<1){i[3]=l*c,i[4]=l,i[5]=0,i[6]=(l-i[3])/2,i[7]=i[3]/2,i[8]=2*l,i[9]=2*l/c;let e=(k.navWidth-k.navHeight*c)/2;u.append(`<span><img src="${o}" height="${k.navHeight}" style="left:${e}px;"/></span>`)}return i}e.fn.extend({ecommercezoom:function(t,n){if(0===arguments.length||"object"==typeof t&&!n){if(0!==this.length)return N.init.apply(this,arguments);e.error("Selector is empty when call jQuery.exzomm")}else{if(N[t])return N[t].apply(this,Array.prototype.slice.call(arguments,1));e.error("Method "+t+"does not exist on jQuery.exzomm")}}})}(jQuery,window);